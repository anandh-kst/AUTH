openapi: 3.0.0

info:
  title: AUTH Service API
  version: 1.0.0
  description: Authentication and User Profile API Documentation

servers:
  - url: http://localhost:3002/api
  - url: https://healthapp-auth.vercel.app/api

tags:
  - name: Auth
    description: Authentication Endpoints

paths:
  ## SEND OTP
  /user/sendOtp:
    post:
      summary: Send OTP to user email
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email:
                  type: string
                  example: "user@gmail.com"
                isChangePassword:
                  type: boolean
                  example: false
      responses:
        "200":
          description: OTP sent successfully
        "400":
          description: Invalid request or email
        "404":
          description: Email not registered or already exists

  ## VERIFY OTP
  /user/verifyOtp:
    post:
      summary: Verify OTP sent to email
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, otp]
              properties:
                email:
                  type: string
                  example: "user@gmail.com"
                otp:
                  type: string
                  example: "123456"
      responses:
        "200":
          description: OTP verified successfully
        "400":
          description: Invalid or expired OTP

  
  
  
  ## VERIFY OTP
  /user/register:
    post:
      summary: Create a new user or update user profile
      tags: [Auth]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              oneOf:
                - type: object
                  description: Create new user (email + password only)
                  required:
                    - email
                    - password
                  properties:
                    email:
                      type: string
                      format: email
                      example: "test@gmail.com"
                    password:
                      type: string
                      example: "StrongPass@123"
                - type: object
                  description: Update existing user profile (with optional JWT token)
                  properties:
                    userToken:
                      type: string
                      description: JWT token for updating profile
                    email:
                      type: string
                      example: "test@gmail.com"
                    password:
                      type: string
                      example: "StrongPass@123"
                    firstName:
                      type: string
                    lastName:
                      type: string
                    dob:
                      type: string
                      example: "1999-05-20"
                    gender:
                      type: string
                      enum: [male, female, other]
                    phoneNumber:
                      type: string
                    address1:
                      type: string
                    address2:
                      type: string
                    city:
                      type: string
                    state:
                      type: string
                    pincode:
                      type: string
                    bloodGroup:
                      type: string
                      example: "O+"
                    pan:
                      type: string
                    adhaar:
                      type: string
                    profileImage:
                      type: string
                      format: binary
      responses:
        "201":
          description: User created successfully
        "200":
          description: User updated successfully
        "400":
          description: Validation error or missing fields
        "404":
          description: User or profile not found
        "500":
          description: Server error

  ## LOGIN USER
  /user/login:
    post:
      summary: Login user with email and password
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  example: "user@gmail.com"
                password:
                  type: string
                  example: "Pass@123"
      responses:
        "200":
          description: Login successful
        "400":
          description: Invalid credentials
        "404":
          description: User not found

  ## FORGOT PASSWORD (RESET PASSWORD)
  /user/forgotPassword:
    post:
      summary: Reset user password using verified OTP
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  example: "user@gmail.com"
                password:
                  type: string
                  example: "NewStrongPass@123"
      responses:
        "200":
          description: Password updated successfully
        "400":
          description: Validation or OTP error
        "404":
          description: User not found

  ## GET USER PROFILE (Protected)
  /user/getUser:
    get:
      summary: Get authenticated user profile
      tags: [Auth]
      security:
        - bearerAuth: []
      responses:
        "200":
          description: User profile data returned
        "401":
          description: Unauthorized
        "404":
          description: User not found

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
